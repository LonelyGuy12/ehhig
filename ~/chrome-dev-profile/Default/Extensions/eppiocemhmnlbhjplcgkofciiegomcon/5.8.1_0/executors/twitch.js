(()=>{function j(j,Z,e,u,i=null){try{document.location.host;let M="detector",o=e;!o&&i&&(o=i[0]?.type?i[0].type:null);let m={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"VIDEO_XHR_CANDIDATE",from:M,to:M.substring(0,M.length-2),content:{requestMethod:j,url:Z,type:o,content:u}};if(i&&i instanceof Promise)return void i.then((j=>{m.content.encodedPostBody=j,m.type="VIDEO_TWITCH_INSTREAM_DATA",window.postMessage(m,"*")}));u?.includes("streamPlaybackAccessToken")&&(m.type="VIDEO_TWITCH_INSTREAM_DATA"),window.postMessage(m,"*")}catch(j){}}let Z=XMLHttpRequest.prototype.open,e=XMLHttpRequest.prototype.send,u=fetch;XMLHttpRequest.prototype.open=function(){this.requestMethod=arguments[0],Z.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){const Z=Object.assign(arguments,{});let u=this.onreadystatechange;return this.onreadystatechange=function(){if(4!==this.readyState||function(j){const Z=document.querySelector("script[data-bis-config]")?JSON.parse(document.querySelector("script[data-bis-config]").getAttribute("data-bis-config")):null;return!!Z&&Z.some((Z=>j.includes(Z)))}(this.responseURL)||j(this.requestMethod,this.responseURL,this.getResponseHeader("content-type"),this.response,Z),u)return u.apply(this,arguments)},e.apply(this,arguments)},fetch=function(){const Z=arguments;let e=arguments[0]instanceof Request?arguments[0].url:arguments[0];const i=arguments[0]instanceof Request?arguments[0].method:arguments[1]?.method?arguments[1].method:"GET",M="POST"===i?arguments[1].body:null;return"object"==typeof e&&e.href&&(e=e.href),new Promise(((o,m)=>{u.apply(this,Z).then((function(Z){if(Z.body instanceof ReadableStream){const u=Z.headers.get("content-type"),o=Z.json;Z.json=function(){return new Promise(((m,w)=>{o.apply(this,arguments).then((function(o){0!==Z.url.search(/data:application\/json;base64/)&&j(i,e,u,JSON.stringify(o),M),m(o)})).catch((function(j){w(j)}))}))};const m=Z.text;Z.text=function(){return new Promise(((o,w)=>{m.apply(this,arguments).then((function(m){0!==Z.url.search(/data:application\/json;base64/)&&j(i,e,u,m,M),o(m)})).catch((function(j){w(j)}))}))},new RegExp("video-edge.*.ts$").test(e)&&"POST"===i&&M?.arrayBuffer&&j(i,e,M.type,null,M.text())}o.apply(this,arguments)})).catch((function(j){m.apply(this,arguments)}))}))}})();