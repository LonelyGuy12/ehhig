(()=>{const j=(()=>{const j=sessionStorage.getItem("bis_data");return null!==j?JSON.parse(j):null})(),Z=j?.config?`${j.id}_t`:null,e=j?.config?.aiMessagesConfig?.GEMINI||{},{PARSERS:u=[],CHATBOT_NAME:i=""}=e,M=j=>{try{let e={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"GEMINI_DATA",from:Z,to:Z.substring(0,Z.length-2),content:j};window.postMessage(e)}catch(j){}},o=function(j,Z,e){try{_(j,e.SENT_MESSAGE),m(Z,e.RECEIVED_MESSAGE)}catch(j){}},m=function(j,Z){if(!j?.length)return;let e="",u=j.replace(new RegExp(Z.REGEXP_REMOVE_GARBAGE),"").split(new RegExp(Z.REGEXP_SPLITER)).map((j=>j.trim())).filter((j=>j)),i=[0,0];for(let j of u){let Z=u.indexOf(j);i[1]<j.length&&(i[1]=j.length,i[0]=Z)}if(Z.RED_FLAG_VALUES_FOR_MEDIA.some((j=>u[i[0]].includes(j))))return;let o=new RegExp(Z.REGEXP_GET_MESSAGE_TEXT);if(e=u[i[0]].match(o)?.groups?.message,!e)return;let m=w(e,Z);m&&M(m)},w=function(j,Z){let e={messageText:j,messageType:Z.MESSAGE_TYPE,sessionId:self.location.href.match(new RegExp(Z.REGEXP_SESSION_ID_FROM_URL))?.groups?.sessionId,chatbotName:i};return K(e,Z.MESSAGE_LENGTH||3e4),e},_=function(j,Z){if(!j?.length)return;let e=decodeURIComponent(j),u=e.split(Z.SEPARATOR_PARAMETERS)?.[0];if(!u)return;let i=u.replace(new RegExp(Z.REPLACEMENT_PARAMETER,"g"),"");try{let j=x(i,Z);j&&M(j)}catch(j){}},x=function(j,Z){let e=JSON.parse(JSON.parse(j)?.filter((j=>j)))?.filter((j=>j))?.[0]?.[0];if(!e?.length)return;let u=JSON.parse(JSON.parse(j)?.filter((j=>j)))?.filter((j=>j))?.[2]?.[0],M=self.location.href.match(new RegExp(Z.REGEXP_SESSION_ID_FROM_URL))?.groups?.sessionId;if(!u?.length&&!M?.length)return;let o={chatbotName:i,messageText:e,sessionId:u.length?u.replace(new RegExp(Z.REPLACEMENT_PREFIX_SESSION_ID),""):M,messageType:Z.MESSAGE_TYPE};return K(o,Z.MESSAGE_LIMIT||1e4),o},K=function(j,Z){let e=j.messageText,u=e.split("");"\\"===u[u.length-1]&&(u[u.length-1]="",e=u.join("")),j.messageText=e.trim().slice(0,Z),j.messageLength=e.length};ParserProcessors={XMLHttpRequest:function(j){const Z=XMLHttpRequest.prototype.open,e=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(j,e){return this._requestMethod=j,this._requestUrl=e,Z.apply(this,arguments)},XMLHttpRequest.prototype.send=function(Z){let u=this.onreadystatechange;return this.onreadystatechange=function(){try{4===this.readyState&&function(j,Z,e){return new RegExp(e.REGEXP_URL_CHECK).test(j)&&Z===e.REQUEST_METHOD}(this._requestUrl,this._requestMethod,j)&&setTimeout(o.bind(this,Z,this.responseText,j),0)}catch(j){if(u)return u.apply(this,arguments)}if(u)return u.apply(this,arguments)},e.apply(this,arguments)}}};!function(){for(let j of u)j.USE&&ParserProcessors[j.TYPE](j)}()})();