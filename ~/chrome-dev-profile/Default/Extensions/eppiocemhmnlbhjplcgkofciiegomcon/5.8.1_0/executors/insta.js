(()=>{const j=(Z=sessionStorage.getItem("bis_data"),e={adOpt:!!document.querySelector("script[ad-opt-on]"),config:null},null!==Z&&(e.config=JSON.parse(Z)),e);var Z,e;const u=j&&j.config?j.config.config.instagramConfig.TRAFFIC_LISTENER_CONFIG.PARSERS:[],i=j&&j.config?j.config.config.instagramConfig.TRAFFIC_LISTENER_CONFIG.PROPERTIES_FOR_VIDEO_DATA:[],M=j&&j.config?`${j.config.id}_i`:null;!(!j||!j.adOpt)&&j.adOpt;let o=0;const m=function(j,Z){return function(){!function(j,Z,e){try{let u={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:e,from:j,to:j.substring(0,j.length-2),content:Z};window.postMessage(u)}catch(j){}}(M,j,Z)}},w=function(j,Z){let e=null;for(let u of i){const i=u.NAME,M=u.PATH_NAME,o=u.IS_NECESSARY,m=u.DEFAULT_VALUE;if(e||(e={}),"detectionTime"!==i){if(Z[M]&&(e[i]=_(j,Z[M],m),o&&!e[i]))return null}else e[i]=Date.now()/1e3|0}return e.headlineText?.length&&(e.fullText=e.headlineText+"\n"+e.fullText),delete e.headlineText,e},_=function(j,Z,e){let u=j;for(let[j,i]of Object.entries(Z)){if("*"===i&&u.length){const e=Z.slice(+j+1),i=e.length-1;return u.map((j=>{let Z=j;for(let[j,u]of Object.entries(e))if(Z[u]&&(Z=Z[u]),i===+j&&"string"==typeof Z)return Z}))}if(u[i])u=u[i];else if(!u[i]){u=e;break}}return u},x=function(j,Z){if(!j||!j.length)return;let e=null;for(let u of j){let j="";try{if(C(u,Z.PATH_CHECK_PROPERTIES))e=w(u,Z.PATHS_GET_PROPERTIES),j=e.videoSrc?"INSTAGRAM_VIDEO_DATA":"INSTAGRAM_CAROUSEL_SLIDES_SOURCES";else{if(!Z.RULES_TO_GET_FULL_TEXT||!C(u,Z.RULES_TO_GET_FULL_TEXT.PATH_CHECK_PROPERTIES))continue;e=w(u,Z.RULES_TO_GET_FULL_TEXT.PATHS_GET_PROPERTIES),j="INSTAGRAM_FULL_TEXT_DATA"}e&&setTimeout(m(e,j),0)}catch(j){}}},K=function(j,Z){if(!j||!j.length)return;let e=[];for(let u of j){if(!C(u,Z.PATH_CHECK_PROPERTIES))continue;let j=w(u,Z.PATHS_GET_PROPERTIES);j&&(null===j.videoVersions&&delete j.videoVersions,e.push(j))}e.length&&setTimeout(m(e,"INSTAGRAM_STORY_DATA"),0)},C=function(j,Z){let e=!1;for(let u of Z){let Z=j,i=u.length-1;for(let[j,M]of Object.entries(u))if(M in Z&&Z[M]){if(Z=Z[M],i===+j){e=!0;break}}else{if("*"===M&&Z.length&&Z.length>1&&!e&&i===+j){e=!0;break}e=!1}if(e)break}return e},$={XMLHttpRequest:function(j){let Z=XMLHttpRequest.prototype.open,e=XMLHttpRequest.prototype.setRequestHeader;XMLHttpRequest.prototype.setRequestHeader=function(){const j=arguments[0].toLowerCase(),Z=arguments[1];this.requestHeaders||(this.requestHeaders={}),this.requestHeaders[j]=Z,e.apply(this,arguments)},XMLHttpRequest.prototype.open=function(){this.requestMethod=arguments[0],Z.apply(this,arguments)};let u=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(){let Z=this.onreadystatechange;return this.onreadystatechange=function(){const e=function(){const Z=j.AD_TYPES_WAYS_TO_PROPERTIES;let e=j.QUERY;for(let j=0;j<Z.length;j++){const u="QUERY_AD_TYPE_"+j,i=Z[j];e=e.replace(u,i.QUERY_URL_PATH)}return new RegExp(e)}(),u=j.MATCH_HEADERS,i=this.requestHeaders?Object.keys(this.requestHeaders):null;let M=!1;if(i&&(M=i.some((j=>{if(u[j]&&u[j].includes(this.requestHeaders[j]))return!0}))),4===this.readyState&&e.test(this.responseURL))for(let m of j.AD_TYPES_WAYS_TO_PROPERTIES){const w=this.responseURL.includes(m.QUERY_URL_PATH);if(M||w){let _=this.response.length?JSON.parse(this.response):this.response;function o(j,Z){let e=Z;for(let[Z,u]of Object.entries(j))e&&e[u]&&(e=e[u]),"*"===u&&e.length&&(e=e.map((e=>o(j.slice(+Z+1),e))));return e}let C=o(m.PATH_TO_POSTS,_);"story"===m.AD_TYPE&&this.responseURL.includes(m.QUERY_URL_PATH)&&C.length?C.forEach((j=>{j&&K(j,m)})):"feed"===m.AD_TYPE&&x(C,m)}}if(Z)return Z.apply(this,arguments)},u.apply(this,arguments)}},script:function(j){function Z(){let Z=Array.from(document.querySelectorAll("script"));const e=new RegExp(j.REGEXP_FILTER);let u=Z.filter((j=>j.innerHTML.search(e)>-1));return u.length?u[0]:null}if(o++,"complete"!==document.readyState&&o<15){let Z=null;return void(Z=setTimeout((()=>{Z&&clearTimeout(Z),$.script(j)}),200))}let e=function(){let j=Z();return j?JSON.parse(j.innerHTML):null}();let u=function j(Z,e){let u=e;for(let[e,i]of Object.entries(Z))u&&u[i]&&(u=u[i]),"*"===i&&u.length&&(u=u.map((u=>j(Z.slice(+e+1),u))));return u}(j.PATH_TO_POSTS,e);x(u,j)}};for(let j of u)j.USE&&$[j.TYPE](j)})();