(()=>{const j=(()=>{const j=sessionStorage.getItem("bis_data");if(null!==j){return JSON.parse(j)}return null})(),Z=j?.config?`${j.id}_t`:null,e=j?.config?.aiMessagesConfig?.COPILOT||{},{PARSERS:u=[],CHATBOT_NAME:i=""}=e;ParserProcessors={WS:function(j){const Z=window.WebSocket;window.WebSocket=class extends Z{#j=!1;#Z="";#e=null;constructor(Z,e){super(Z,e),super.addEventListener("message",(Z=>{try{const{MESSAGE_LIMIT:e=3e4,EVENT_TYPE_QUERY:u=[],START_EVENT_TYPE:i,APPEND_EVENT_TYPE:o,DONE_EVENT_TYPE:m,CONVERSATION_ID_QUERY:w=[],TEXT_QUERY:_=[]}=j.RECEIVED_MESSAGE||{},x=Z.data||"{}",K=JSON.parse(x),C=M(u,K);C===i&&this.#u(w,K),this.#j&&C===o&&this.#i(_,K),C===m&&this.#M(e)}catch(j){}}))}send(Z){try{const{MESSAGE_LIMIT:e=1e4,EVENT_TYPE_QUERY:u=[],EVENT_TYPE:i,CONVERSATION_ID_QUERY:m=[],CONTENT_QUERY:w=[],CONTENT_TYPE_QUERY:_=[],CONTENT_TYPE_TEXT:x,CONTENT_TEXT_QUERY:K=[]}=j.SEND_MESSAGE||{},C=JSON.parse(Z),$=M(u,C),W=M(w,C),a=M(m,C);if($!==i)return super.send(Z);const g=W.find((j=>M(_,j)===x));if(!g)return super.send(Z);const P=M(K,g);P&&a&&o(P,e,a)}catch(j){}return super.send(Z)}#u(j,Z){this.#j=!0,this.#e=M(j,Z)}#i(j,Z){this.#Z=this.#Z+M(j,Z)}#M(j){o(this.#Z,j,this.#e,"system"),this.#j=!1,this.#Z="",this.#e=null}}}};const M=(j,Z)=>j.reduce(((j,Z)=>j?"object"==typeof j?j[Z]:j:null),Z),o=(j,Z,e,u)=>{if(j&&e){const i=m(j,Z,e,u);i&&w(i)}},m=function(j,Z,e,u="user"){return{chatbotName:i,messageType:u,sessionId:e,messageLength:j.length,messageText:j.trim().slice(0,Z)}},w=j=>{try{let e={posdMessageId:"PANELOS_MESSAGE",posdHash:(Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)).substring(0,22),type:"COPILOT_DATA",from:Z,to:Z.substring(0,Z.length-2),content:j};window.postMessage(e)}catch(j){}};for(let j of u)j.USE&&ParserProcessors[j.TYPE](j)})();